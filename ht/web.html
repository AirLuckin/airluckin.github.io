<!DOCTYPE html>
<html lang='en'>
<<<<<<< HEAD
<head> 
<meta charset="utf-8"> 
<meta name='viewport' content='width=device-width, initial-scale=1.0' />
<title>通用调试工具</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
<style>
canvas{
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

html, body {
  width: 100%;
  height: 100%; 
  margin:0 auto;padding:0px
}
.container {
  display: flex;
  height: 100%;
}

.left, .right, .up, .down {
  box-sizing: border-box;
  /* padding: 2px; */
}

.left {
  width: 320px;
  background: lightblue;
}

.right {
  flex: 1 1 auto;
}

.up {
  height: 70%;
  background: #181818;
}

.down {
  height: 30%;
  background: darkcyan;
} 

.item_head{
  background: lightseagreen;
  width: 320px;
  height: 25px;
}

.item_subhead{
  background: lightgray;
  width: 320px;
  height: 24px;
}

.input_hz, .input_duty {
  border: none;
  outline: none;
}

.input_hz{
  width: 40px;
}

.input_duty{
  width: 30px;
}

button {
  float: right;
}
</style>
</head>
 
<body>
	<div class="container">
		<div class="left">
			<div class="item_left">
        <div class="item_head">
          <label>IO14 freq</label>
          <input id='timer0_freq' class="input_hz">Hz
          <label>def_duty</label>
            <input id='timer0_duty0' class="input_duty">%
          <button id='btn_timer0' onkeypress = "keypress('timer0')">设置</button>
        </div>
        <div class="item_left">
          <div>
            <label><input id="timer0_check1" type="checkbox" value="" /> if</label> 
            <select id='timer0_check_io1'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer0_check_cond1'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer0_check_duty1' class="input_duty">% set duty
            <input id='timer0_duty1' class="input_duty">%
          </div>
          <div>
            <label><input id="timer0_check2" type="checkbox" /> if</label> 
            <select id='timer0_check_io2'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer0_check_cond2'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer0_check_duty2' class="input_duty">% set duty
            <input id='timer0_duty2' class="input_duty">%
          </div>
          <div>
            <label><input id="timer0_check3" type="checkbox" value="" /> if</label> 
            <select id='timer0_check_io3'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer0_check_cond3'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer0_check_duty3' class="input_duty">% set duty
            <input id='timer0_duty3' class="input_duty">%
          </div>
          <div>
            <label><input id="timer0_check4" type="checkbox" value="" /> if</label> 
            <select id='timer0_check_io4'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer0_check_cond4'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer0_check_duty4' class="input_duty">% set duty
            <input id='timer0_duty4' class="input_duty">%
          </div>
          <div>
            <label><input id="timer0_check5" type="checkbox" value="" /> if</label> 
            <select id='timer0_check_io5'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer0_check_cond5'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer0_check_duty5' class="input_duty">% set duty
            <input id='timer0_duty5' class="input_duty">%
          </div>  
        </div>
        <div class="item_head">
          <label>IO15 freq</label>
          <input id='timer1_freq' class="input_hz">Hz
          <label>def_duty</label>
            <input id='timer1_duty0' class="input_duty">%
          <button id='btn_timer1' onkeypress = "keypress('timer1')">设置</button>
        </div>
        <div class="item_left">
          <div>
            <label><input id="timer1_check1" type="checkbox" value="" /> if</label> 
            <select id='timer1_check_io1'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer1_check_cond1'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer1_check_duty1' class="input_duty">% set duty
            <input id='timer1_duty1' class="input_duty">%
          </div>
          <div>
            <label><input id="timer1_check2" type="checkbox" /> if</label> 
            <select id='timer1_check_io2'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer1_check_cond2'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer1_check_duty2' class="input_duty">% set duty
            <input id='timer1_duty2' class="input_duty">%
          </div>
          <div>
            <label><input id="timer1_check3" type="checkbox" value="" /> if</label> 
            <select id='timer1_check_io3'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer1_check_cond3'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer1_check_duty3' class="input_duty">% set duty
            <input id='timer1_duty3' class="input_duty">%
          </div>
          <div>
            <label><input id="timer1_check4" type="checkbox" value="" /> if</label> 
            <select id='timer1_check_io4'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer1_check_cond4'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer1_check_duty4' class="input_duty">% set duty
            <input id='timer1_duty4' class="input_duty">%
          </div>
          <div>
            <label><input id="timer1_check5" type="checkbox" value="" /> if</label> 
            <select id='timer1_check_io5'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer1_check_cond5'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer1_check_duty5' class="input_duty">% set duty
            <input id='timer1_duty5' class="input_duty">%
          </div>
        </div>
=======
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>通用调试工具</title>
    <style>
      form {
        padding: 20px;
        width: 400px;
        box-shadow: 0 0 20px #888;
        border-radius: 1px;
        box-sizing: border-box;
        margin: auto;
        background-color: lightblue;
        display: grid;
        gap: 10px;
      }
      h3 {
        text-align: center;
      }
      h5 {
        text-align: center;
      }
      input {
        height: 30px;
        width: 50px;
        border: none;
        outline: none;
      }
      select {
        background-color: Gainsboro ;
        height: 30px;
        width: 60px;
        border: none;
        outline: none;
      }
    </style>
  </head>
  <body>
    <h3>通用调试工具</h3>
    <h5>app version: %s     release time: %s</h5>
    <form id ='form1'action='ctrl' method='get'>
      <div id='IO1'>
        <label>IO1：</label>
		    <select id='IO1_mode' name='IO1_mode' onchange="changeStateById('IO1_mode')">
          <option value='0'>输入</option>
          <option value='1'>输出</option>
			    <option value='2'>pwm</option>
        </select>
		    <select id='IO1_pull' name='IO1_pull' onchange="changeStateById('IO1_pull')">
          <option value='0'>浮空</option>
          <option value='1'>上拉</option>
			    <option value='2'>下拉</option>
        </select>
>>>>>>> parent of 461a0c2 (Update web.html)
      </div>
      <div class="item_left">
        <div class="item_head">
          <label>IO16 freq</label>
          <input id='timer2_freq' class="input_hz">Hz
          <label>def_duty</label>
            <input id='timer2_duty0' class="input_duty">%
          <button id='btn_timer2' onkeypress = "keypress('timer2')">设置</button>
        </div>
        <div class="item_left">
          <div>
            <label><input id="timer2_check1" type="checkbox" value="" /> if</label> 
            <select id='timer2_check_io1'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer2_check_cond1'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer2_check_duty1' class="input_duty">% set duty
            <input id='timer2_duty1' class="input_duty">%
          </div>
          <div>
            <label><input id="timer2_check2" type="checkbox" /> if</label> 
            <select id='timer2_check_io2'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer2_check_cond2'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer2_check_duty2' class="input_duty">% set duty
            <input id='timer2_duty2' class="input_duty">%
          </div>
          <div>
            <label><input id="timer2_check3" type="checkbox" value="" /> if</label> 
            <select id='timer2_check_io3'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer2_check_cond3'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer2_check_duty3' class="input_duty">% set duty
            <input id='timer2_duty3' class="input_duty">%
          </div>
          <div>
            <label><input id="timer2_check4" type="checkbox" value="" /> if</label> 
            <select id='timer2_check_io4'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer2_check_cond4'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer2_check_duty4' class="input_duty">% set duty
            <input id='timer2_duty4' class="input_duty">%
          </div>
          <div>
            <label><input id="timer2_check5" type="checkbox" value="" /> if</label> 
            <select id='timer2_check_io5'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer2_check_cond5'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer2_check_duty5' class="input_duty">% set duty
            <input id='timer2_duty5' class="input_duty">%
          </div>
        </div>
        <div class="item_head">
          <label>IO17 freq</label>
          <input id='timer3_freq' class="input_hz">Hz
          <label>def_duty</label>
            <input id='timer3_duty0' class="input_duty">%
          <button id='btn_timer3' onkeypress = "keypress('timer3')">设置</button>
        </div>
        <div class="item_left">
          <div>
            <label><input id="timer3_check1" type="checkbox" value="" /> if</label> 
            <select id='timer3_check_io1'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer3_check_cond1'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer3_check_duty1' class="input_duty">% set duty
            <input id='timer3_duty1' class="input_duty">%
          </div>
          <div>
            <label><input id="timer3_check2" type="checkbox" /> if</label> 
            <select id='timer3_check_io2'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer3_check_cond2'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer3_check_duty2' class="input_duty">% set duty
            <input id='timer3_duty2' class="input_duty">%
          </div>
          <div>
            <label><input id="timer3_check3" type="checkbox" value="" /> if</label> 
            <select id='timer3_check_io3'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer3_check_cond3'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer3_check_duty3' class="input_duty">% set duty
            <input id='timer3_duty3' class="input_duty">%
          </div>
          <div>
            <label><input id="timer3_check4" type="checkbox" value="" /> if</label> 
            <select id='timer3_check_io4'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer3_check_cond4'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer3_check_duty4' class="input_duty">% set duty
            <input id='timer3_duty4' class="input_duty">%
          </div>
          <div>
            <label><input id="timer3_check5" type="checkbox" value="" /> if</label> 
            <select id='timer3_check_io5'>
              <option value='0'>IO32</option>
              <option value='1'>IO33</option>
              <option value='2'>IO34</option>
              <option value='3'>IO35</option>
            </select>
            <select id='timer3_check_cond5'>
              <option value='0'><</option>
              <option value='1'>=</option>
              <option value='2'>></option>
            </select>
            <input id='timer3_check_duty5' class="input_duty">% set duty
            <input id='timer3_duty5' class="input_duty">%
          </div>
        </div>
      </div>
<<<<<<< HEAD
		</div>
		<div class="right">
		  <div class="up">
        <canvas id="myChart" width="400" height="160"></canvas>
      </div>
      <button id="randomizeData">clear</button>
		  <div class="down">
        <div id="sse">
          <a href="javascript:WebSocketTest()">运行 WebSocket</a>
        </div>
		  </div>
		</div>
	</div> 
</body>
=======
      <div id='output1'>
        <label>输出：</label>
        <select id='level1' onchange="changeStateById('level1')">
          <option value='0'>低电平</option>
          <option value='1'>高电平</option>
        </select>
      </div>
      <div id='pwm1'>
        <label>周期：</label>
        <input id='period1' onchange="changeStateById('period1')">
        <label>占空比：</label>
        <input id='duty1' onchange="changeStateById('duty1')">
      </div>
      <label>----------------------------------------------------</label>
      <div id='IO2'>
        <label>IO2：</label>
        <select id='IO2_mode' name='IO2_mode' onchange="changeStateById('IO2_mode')">
          <option value='0'>输入</option>
          <option value='1'>输出</option>
          <option value='2'>pwm</option>
        </select>
        <select id='IO2_pull' name='IO2_pull' onchange="changeStateById('IO2_pull')">
          <option value='0'>浮空</option>
          <option value='1'>上拉</option>
          <option value='2'>下拉</option>
        </select>
      </div>
      <div id='input2'>
        <label>当前电平：</label>
        <label></label>
      </div>
      <div id='output2'>
        <label>输出：</label>
        <select id='level2' onchange="changeStateById('level2')">
          <option value='0'>低电平</option>
          <option value='1'>高电平</option>
        </select>
      </div>
      <div id='pwm2'>
        <label>周期：</label>
        <input id='period2' onchange="changeStateById('period2')">
        <label>占空比：</label>
        <input id='duty2' onchange="changeStateById('duty2')">
      </div>
      <label>----------------------------------------------------</label>
      <div id='adc'>
        <label>adc比例：</label>
        <input id='scale' onchange="changeStateById('scale')">
        <label>当前ad值：</label>
        <label id='adc' onchange="changeStateById('adc')"></label>
      </div>
      <div id="sse">
        <a href="javascript:WebSocketTest()">运行 WebSocket</a>
      </div>
    </form>
  </body>
>>>>>>> parent of 461a0c2 (Update web.html)
</html>

<script src="https://www.jq22.com/jquery/jquery-3.3.1.js"></script>
<script type='text/javascript'>
  var ws;

  function changeStateById(id)
  {
    var i = document.getElementById(id);
    var obj = new Object();
    obj[id] = Number(i.value);
    console.log("changeStateById: %s",id);
    dp = JSON.stringify(obj);
    ws.send(dp);
    console.log(dp);
  }

  function test(index)
  {
    $('#IO2_pull').val(index);
  }


  function deal_with_recdata(data)  
  {
    var obj = JSON.parse(data);
    console.log(obj.a);
    // if(obj.IO1_mode)
  }

  function send_data()  
  {
    var obj = {"a":"aaa","b":"bbb"};
    dp = JSON.stringify(obj);
    ws.send(dp);//
  }

  function WebSocketTest()
  {
    alert("WebSocket启动!"); 
    if ("WebSocket" in window)
    {
      console.log("您的浏览器支持 WebSocket!"); 
      // 打开一个 web socket
      ws = new WebSocket("ws://%s:80/ws");
      ws.onopen = function()
      {
        // Web Socket 已连接上，使用 send() 方法发送数据
        // ws.send("发送数据");
        send_data();
        console.log("数据发送中...");
      };
      
      ws.onmessage = function (evt) 
      { 
        var received_msg = evt.data;
        console.log("数据已接收...");
        console.log(received_msg);
        deal_with_recdata(received_msg);
      };
      
      ws.onclose = function()
      { 
        // 关闭 websocket
        alert("连接已关闭..."); 
      };
    }
    
    else
    {
      // 浏览器不支持 WebSocket
      alert("您的浏览器不支持 WebSocket!");
    }
  }
</script>
